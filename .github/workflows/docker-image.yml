name: Docker Image CI
on: [push]
jobs:

  build:

    runs-on: ubuntu-latest

    steps:
    - name: Docker Login
  # You may pin to the exact commit or the version.
  # uses: docker/login-action@f054a8b539a109f9f41c372932f1ae047eff08c9
      uses: docker/login-action@v1.10.0
      with:
    # Server address of Docker registry. If not set then will default to Docker Hub
    # Username used to log against the Docker registry
        username: 20201231
    # Password or personal access token used to log against the Docker registry
        password: d068dea4-ea3a-4a99-977e-1da32e509256
    # Log out from the Docker registry at the end of a job
    - run: docker pull k8s.gcr.io/ingress-nginx/controller:v0.46.0@sha256:52f0058bed0a17ab0fb35628ba97e8d52b5d32299fbc03cc0f6c7b9ff036b61a 
    - run: docker tag k8s.gcr.io/ingress-nginx/controller:v0.46.0@sha256:52f0058bed0a17ab0fb35628ba97e8d52b5d32299fbc03cc0f6c7b9ff036b61a 20201231/ingress-nginx-controller:v0.46.0
    - run: docker push 20201231/ingress-nginx-controller:v0.46.0
